# Netwatch ISP Test
# email from router with ISP name. Check 8.8.8.8 and 77.88.8.8
/tool netwatch add host=8.8.8.8 timeout=3s interval=1m up-script=":log debug \"Starting ISP Test Script...\";\r\n:local sysname [/system identity get name];\r\n:local smtpserv [:resolve \"smtp.YOUR_MAIL_SERVER.com\"];\r\n:local Eaccount \"mikrotik-service@YOUR_MAIL_SERVER.com\";\r\n:local pass \"PASSWORD\";\r\n:local ISP1 [/ip route get [find dst-address=8.8.8.8/32] comment]\r\n:local ISP2 [/ip route get [find dst-address=77.88.8.8/32] comment]\r\n:log debug \"Sending information via E-mail...\";\r\n/tool e-mail send from=\"<\$Eaccount>\" to=\$Eaccount server=\$smtpserv port=PORT user=\$Eaccount password=\$pass start-tls=yes subject=(\"\$sysname ISP information (\" . [/system clock get date] . \")\") body=(\"\$sysname \$ISP1 is up .\nTime and Date stamp: \" . [/system clock get time] . \" \" . [/system clock get date]);\r\n:log debug \"ISP Test Complete!\";" down-script=":log debug \"Starting ISP Test Script...\";\r\n:local sysname [/system identity get name];\r\n:local smtpserv [:resolve \"smtp.YOUR_MAIL_SERVER.com\"];\r\n:local Eaccount \"mikrotik-service@YOUR_MAIL_SERVER.com\";\r\n:local pass \"PASSWORD\";\r\n:local ISP1 [/ip route get [find dst-address=8.8.8.8/32] comment]\r\n:local ISP2 [/ip route get [find dst-address=77.88.8.8/32] comment]\r\n:log debug \"Sending information via E-mail...\";\r\n/tool e-mail send from=\"<\$Eaccount>\" to=\$Eaccount server=\$smtpserv port=PORT user=\$Eaccount password=\$pass start-tls=yes subject=(\"\$sysname ISP information (\" . [/system clock get date] . \")\") body=(\"\$sysname \$ISP1 is down .\nTime and Date stamp: \" . [/system clock get time] . \" \" . [/system clock get date]);\r\n:log debug \"ISP Test Complete!\";"
/tool netwatch add host=77.88.8.8 timeout=3s interval=1m up-script=":log debug \"Starting ISP Test Script...\";\r\n:local sysname [/system identity get name];\r\n:local smtpserv [:resolve \"smtp.YOUR_MAIL_SERVER.com\"];\r\n:local Eaccount \"mikrotik-service@YOUR_MAIL_SERVER.com\";\r\n:local pass \"PASSWORD\";\r\n:local ISP1 [/ip route get [find dst-address=8.8.8.8/32] comment]\r\n:local ISP2 [/ip route get [find dst-address=77.88.8.8/32] comment]\r\n:log debug \"Sending information via E-mail...\";\r\n/tool e-mail send from=\"<\$Eaccount>\" to=\$Eaccount server=\$smtpserv port=PORT user=\$Eaccount password=\$pass start-tls=yes subject=(\"\$sysname ISP information (\" . [/system clock get date] . \")\") body=(\"\$sysname \$ISP2 is up .\nTime and Date stamp: \" . [/system clock get time] . \" \" . [/system clock get date]);\r\n:log debug \"ISP Test Complete!\";" down-script=":log debug \"Starting ISP Test Script...\";\r\n:local sysname [/system identity get name];\r\n:local smtpserv [:resolve \"smtp.YOUR_MAIL_SERVER.com\"];\r\n:local Eaccount \"mikrotik-service@YOUR_MAIL_SERVER.com\";\r\n:local pass \"PASSWORD\";\r\n:local ISP1 [/ip route get [find dst-address=8.8.8.8/32] comment]\r\n:local ISP2 [/ip route get [find dst-address=77.88.8.8/32] comment]\r\n:log debug \"Sending information via E-mail...\";\r\n/tool e-mail send from=\"<\$Eaccount>\" to=\$Eaccount server=\$smtpserv port=587 user=\$Eaccount password=\$pass start-tls=yes subject=(\"\$sysname ISP information (\" . [/system clock get date] . \")\") \r\nbody=(\"\$sysname \$ISP2 is down .\nTime and Date stamp: \" . [/system clock get time] . \" \" . [/system clock get date]);\r\n:log debug \"ISP Test Complete!\";"